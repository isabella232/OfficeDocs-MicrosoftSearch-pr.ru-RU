---
title: Настройка страницы Поиск (Майкрософт)
ms.author: jeffkizn
author: jypal
manager: jeffkizn
ms.audience: Admin
ms.topic: article
ms.service: mssearch
localization_priority: Normal
search.appverid:
- BFB160
- MET150
- MOE150
description: Добавление вертикали поиска и настройка результатов поиска
ms.openlocfilehash: 0bcb8d8588edf44d4291802d1d9c73b75fd6bf327b19f9a9b1ef0555baca38ad
ms.sourcegitcommit: 71ac2a38971ca4452d1bddfc773ff8f45e1ffd77
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/06/2021
ms.locfileid: "54533068"
---
# <a name="customize-the-search-results-page"></a>Настройка страницы результатов поиска

Вы можете создать вертикали поиска и типы результатов для настройки результатов поиска, которые пользователи видят при поиске в Microsoft [SharePoint,](https://sharepoint.com/) [Microsoft Office](https://office.com)и Поиск (Майкрософт) в [Bing](https://bing.com). Вертикали упрощают поиск пользователями сведений, которые они могут видеть. Например, можно создать вертикаль поиска для анализа маркетинговых данных из сторонних программ для пользователей в отделе маркетинга. Вы также можете определить типы результатов и настроить макет для этих данных.  

На этих уровнях можно создавать вертикали и типы результатов:

- **Уровень** организации — при добавлении вертикали на уровне организации он отображается [](https://sharepoint.com/) на странице результатов [](https://office.com)поиска при поиске пользователей со своей SharePoint страницы, Office или [на Bing](https://bing.com).
- **Уровень сайта** . Например, может потребоваться включить сотрудников службы обслуживания клиентов для поиска инцидентов строгости *1* непосредственно с веб-сайта SharePoint отдела.

## <a name="search-verticals-explained"></a>Объяснили вертикали поиска

В верхней части Поиск (Майкрософт) результатов есть строка вкладок. Это вертикали поиска. Вертикаль поиска показывает только результаты определенного типа или определенного контента. Примерами являются **Файлы** или **Новости.** По умолчанию Поиск (Майкрософт) показывает вертикали **All**, **People**, **Files,** **Sites** и **News**.  

Можно добавить вертикали поиска, которые имеют отношение к организации. Они будут отображаться на странице Поиск (Майкрософт) результатов [в SharePoint,](https://sharepoint.com/) [Office](https://Office.com)и [Bing](https://bing.com). Например, можно создать вертикаль для контента, связанного с маркетингом, а другой для продаж, на основе типа сведений, необходимых каждой группе. Можно добавить вертикали, чтобы показывать результаты только из контента, индексного через соединители.  

### <a name="multiple-connections-in-a-vertical"></a>Несколько подключений в вертикали

Вертикаль поиска теперь может поверхность результатов из нескольких источников соединителя. Это обеспечивает большую гибкость при разработке страницы результатов поиска. Существующий административный опыт вертикальной установки позволяет выбрать несколько подключений в шаге "Источник контента".
Если вы точно назначит как можно больше семантических меток, этот опыт будет улучшен. Можно добавить семантические метки при определении схемы и прогоне.

[Дополнительные](configure-connector.md#step-5-assign-property-labels) сведения о создании и управлении семантическими метами.

> [!NOTE]
> Несколько подключений в вертикали в настоящее время находятся в предварительном просмотре. Дополнительные сведения о предварительной версии см. в [дополнительных сведениях о функции предварительного просмотра соединители.](connectors-overview.md#what-are-the-preview-features)

### <a name="things-you-should-know"></a>Все, что вы должны знать

1. Подключение может быть добавлено в качестве источника контента только в рамках одной вертикали. Повторное подключение к нескольким вертикалям не допускается.
2. Если необходимо настроить запрос для вертикали поиска, в которой добавлено несколько источников подключения, для создания такого запроса необходимо использовать общие исходные свойства.

## <a name="things-to-consider"></a>Важные факторы

Перед началом убедитесь, что соединитектор проиндексировали. Это может занять до 48 часов в зависимости от размера файла.

Вы не можете создать вертикаль для контента, расположенного [в SharePoint.](https://sharepoint.com/)

Существует три основных шага, чтобы добавить вертикаль:

1. Создайте вертикаль. На этом шаге определяется имя, источник контента вертикали и область поиска контента.
2. Определите, как будут выглядеть результаты для этой вертикали.  
3. Включить вертикальную (отображаемую) со страницы вертикального списка.

## <a name="step-1-create-the-search-vertical"></a>ШАГ 1. Создание вертикали поиска

После запуска мастера необходимо определить имя, источник контента и область поиска по вертикали. Вертикаль создается в состоянии отключения. Вы включаете его позже.

Чтобы сузить область, можно использовать ограниченный набор языка запросов ключевых слов [(KQL).](/sharepoint/dev/general-development/keyword-query-language-kql-syntax-reference) На этой странице перечислены доступные свойства. Для создания KQL рекомендуется использовать ключевые слова и ограничения свойств с операторами boolean.
KQL также поддерживает использование [](#profile-query-variables) переменных запросов профилей для точной настройки результатов в вертикальной области.

### <a name="create-a-vertical-at-the-organization-level"></a>Создание вертикали на уровне организации

Чтобы создать вертикаль на Поиск (Майкрософт) в [SharePoint,](https://sharepoint.com/) [Office](https://office.com)или Bing [выполните](https://bing.com)следующие действия:

1. В [Центр администрирования Microsoft 365](https://admin.microsoft.com)перейдите к [**вертикалям**](https://admin.microsoft.com/Adminportal/Home#/MicrosoftSearch/verticals).
2. Выберите **Добавить,** чтобы начать работу.  

### <a name="create-a-vertical-at-the-site-level"></a>Создание вертикали на уровне сайта

1. На [сайте SharePoint,](https://sharepoint.com/) где нужна вертикаль, перейдите **в Параметры.**
2. Выберите **сведения о сайте,** а затем **просмотреть все параметры сайта.**
3. Посмотрите раздел **Поиск (Майкрософт),** а затем выберите **Configure Поиск (Майкрософт) для этой коллекции сайтов.**
4. В области навигации перейдите к **пользовательскому опыту** и выберите вкладку **Verticals.**
5. Чтобы добавить вертикаль, выберите **Добавить**.
  Или, чтобы изменить вертикаль, выберите ее в списке.

Помните, что вертикали создаются в состоянии отключения. Они должны быть включены, прежде чем пользователи смогут их увидеть.

## <a name="step-2-create-the-result-types"></a>ШАГ 2. Создание типов результатов

Вы можете определить, как отображаются результаты в вертикали, путем разработки макета с использованием типов результатов. Макет результатов позволяет показывать важные сведения непосредственно в результатах поиска, поэтому пользователям не нужно выбирать каждый результат, чтобы узнать, нашли ли они то, что ищут.

### <a name="default-search-result-layout"></a>Макет результатов поиска по умолчанию

Макет результатов поиска по умолчанию будет  показан для  контента Connector, если метки и свойство контента были правильно соединялись с исходными свойствами во время настройки соединителю. Название **метки** является наиболее важным меткой. Настоятельно рекомендуется **иметь свойство,** назначенное этой метке, для использования макета результатов поиска по умолчанию.

### <a name="create-your-own-result-type"></a>Создание собственного типа результатов

Вы можете создать собственный макет результатов поиска и переопредить макет результатов поиска по умолчанию, создав **тип результатов.** Тип результата поиска  это правило, благодаря которому результаты поиска разных типов отображаются различными способами. Оно состоит из следующих компонентов.

- **Одно или несколько условий** для сравнения каждого результата поиска, например источника контента результата поиска.  
- Макет **результатов** для использования для результатов поиска, которые соответствуют условиям. Полученный макет управляет тем, как отображаются все результаты, которые соответствуют условиям, и ведут себя на странице результатов поиска.

**Если для отображения макета результатов поиска по умолчанию не сделано соответствующее сопоставление, необходимо создать по крайней мере один тип результатов для отображения результатов в вертикальной области.** Можно создать несколько типов результатов для каждой вертикали, что позволяет использовать различные макеты для различных типов результатов. Например, можно настроить *инциденты строгости 1,* чтобы иметь более заметные цвета и шрифт большего размера по сравнению с инцидентами *строгости 3.*

После запуска мастера вы будете руководствоваться действиями, чтобы определить имя, источник контента и условия для типа результата. Вы можете определить приоритет типа результатов из представления списка.
  
### <a name="create-a-result-type-at-the-organization-level"></a>Создание типа результатов на уровне организации

1. В [Центр администрирования Microsoft 365](https://admin.microsoft.com)перейдите к [**типам Result.**](https://admin.microsoft.com/Adminportal/Home#/MicrosoftSearch/resulttypes)
2. Чтобы добавить тип **Результат,** выберите **Добавить**. Чтобы изменить тип результатов, выберите тип результата в соответствующем списке.

### <a name="create-a-results-type-at-the-site-level"></a>Создание типа результатов на уровне сайта

1. На [сайте SharePoint,](https://sharepoint.com/) на котором необходимо создать тип результата, перейдите **в Параметры.**
2. Выберите **сведения о сайте,** а затем **просмотреть все параметры сайта.**
3. Посмотрите раздел Поиск (Майкрософт), а затем выберите **Configure Поиск (Майкрософт) для этой коллекции сайтов.**
4. В области навигации перейдите к **пользовательскому опыту** и выберите вкладку **тип результатов.**
5. Чтобы добавить тип результата, выберите **Добавить**.  Или, чтобы изменить тип результатов, выберите тип результата в списке.

## <a name="step-3-view-the-vertical-after-its-enabled"></a>ШАГ 3. Просмотр вертикали после включения

После в включить вертикаль, это займет несколько часов, прежде чем вы сможете просмотреть его. Если вы не хотите ждать после включения, вы можете применить **cacheClear=true** к URL-адресу в SharePoint и [Office,](https://office.com) чтобы немедленно просмотреть вертикаль. [](https://sharepoint.com/) Для Bing приложение&**features=uncachedVerticals** в [URL-адрес](https://bing.com)вертикальной работы для немедленного просмотра вертикали.

> [!NOTE]
> Добавленные вертикали не [](https://sharepoint.com/) будут видны на SharePoint [и Office](https://office.com) при просмотре из мобильных веб-браузеров.

## <a name="profile-query-variables"></a>Переменные запроса профилей

Переменные запроса используются в разделе запроса KQL вертикали для предоставления динамических данных в качестве входных данных для запроса вертикали. Вы можете использовать переменные запроса профилей, чтобы сделать результаты поиска контекстными для подписанного пользователя. Переменные запроса профилей извлекли значения из профиля подписанного [пользователя.](/graph/api/resources/profile?view=graph-rest-beta)

Например, если вы хотите создать вертикаль "Билеты", в которой пользователь с входом может искать назначенные им билеты поддержки, можно указать следующий запрос в разделе "Запрос" во время создания вертикали на странице администрирования.  

**AssignedTo:{Profile.accounts.userPrincipalName}**

Это позволит сузить результаты поиска, чтобы показать только те элементы, в которых назначаемая является пользователем, который выполняет поиск.

[Ресурс Profile](/graph/api/resources/profile?view=graph-rest-beta) предоставляет свойства в качестве коллекций. Например, сведения, относящиеся к адресам электронной почты, высвечив их через коллекцию электронной почты, позиции в качестве коллекции позиций и так далее. Все свойства, доступные в профиле пользователя, которые имеют AAD как исходный тип, выставляются в качестве переменных Запроса.

Рассмотрим пользователя, который имеет 3 адреса электронной почты, доступные в коллекции электронной почты, как показано ниже.

```json
"emails": [{ 

        "address": "Megan.Bowen@contoso.com",
        "id": "xyz", 
        "source": { 
            "CreatedBy": "xyz", 
            "CreatedOn": "2222", 
            "Type": "official" 
        },
        "type": "main" 
    }, { 
        "address": "meganb@hotmail.com",
        "id": "abc", 
        "source": { 
            "CreatedBy": "abc",
            "CreatedOn": "3333", 
            "Type": "non-official",
        },
        "type": "work"
    }, { 
        "address": "meganb@outlook.com",
        "id": "pqr", 
        "source": { 
            "CreatedBy": "pqr", 
            "CreatedOn": "4444", 
            "Type": "personal" 
        },
        "type": "personal" 
    } 
] 
```

- Запрос **MyProperty: {Profile.emails.address}** будет решен в MyProperty: "Megan.Bowen@contoso.com".  

- Чтобы устранить все значения атрибута адреса, необходимо использовать синтаксис расширения с несколькими значениями. Запрос **{| MyProperty:{Profile.emails.address}}** разрешит ((MyProperty:"Megan.Bowen@contoso.com") OR (MyProperty: "meganb@hotmail.com") OR (MyProperty:"meganb@outlook.com"))  

Оператор "|" должен использоваться для решения многомерных переменных. Дополнительные примеры расширения профиля см. в таблице ниже.

| #         | Синтаксис |  Возвращено значение  |
| --------- | ------ | --- |
| 1    | MyProperty:{Profile.emails.address}  |   "Megan.Bowen@contoso.com"  |
| 2 | MyProperty:{Profile.emails}   |    {Profile.emails} Это не решится, так как сообщения электронной почты являются объектом.|
| 3    | {? MyProperty:{Profile.emails}}  |  Это не решится, так как сообщения электронной почты являются объектом. The "?" оператор игнорирует переменные запроса, которые не решаются. Эта переменная будет удалена при дальнейшей стеке запросов.   |
| 4  | {&#124;MyProperty: {Profile.emails.source.Type}}    |  ((MyProperty:"official") OR (MyProperty:"non-official") OR (MyProperty:"personal"))    |

> [!NOTE]
>
> - Переменные запроса профилей поддерживаются только для настраиваемой вертикали с помощью [соединителя](connectors-overview.md) в качестве источника контента.
> - Переменные запроса профилей определяются в разделе "Запрос" процесса [вертикальной настройка.](customize-search-page.md#step-1-create-the-search-vertical)
> - Переменные запроса профилей в настоящее время находятся в предварительном просмотре. Дополнительные сведения о предварительной версии см. в [дополнительных сведениях о функции предварительного просмотра соединители.](connectors-overview.md#what-are-the-preview-features)

## <a name="troubleshooting"></a>Устранение неполадок

Вот список распространенных проблем, с которыми вы можете столкнуться, и действия по их устранению.

|Ошибка  |Действие  |
|---------|---------|
| Я вижу сообщение об ошибке "Что-то пошло не так" на вертикали. | Для завершения установки необходимы как вертикальные типы, так и типы результатов. Убедитесь, что вы создали для одного и того же источника контента. |
| Я не вижу макет результатов, хотя создал его. | Это занимает несколько минут, так как эти параметры обычно кэшировали. Подождите несколько минут и попробуйте еще раз.        |
| Я не вижу источников контента на странице вертикального или типа результатов. | Убедитесь, что вы настроили соединители и проиндексировали данные.   |

## <a name="next-steps"></a>Дальнейшие действия

[Настройка макета результатов](customize-results-layout.md)
