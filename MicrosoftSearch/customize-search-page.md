---
title: Настройка страницы Поиск (Майкрософт)
ms.author: jeffkizn
author: jypal
manager: jeffkizn
ms.audience: Admin
ms.topic: article
ms.service: mssearch
localization_priority: Normal
search.appverid:
- BFB160
- MET150
- MOE150
description: Добавление вертикали поиска и настройка результатов поиска
ms.openlocfilehash: 701604798115091c7c7a286d3b6e97dea08e9453
ms.sourcegitcommit: be5dcc7005447d6139e39d86211c7ec4cd5dd907
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2021
ms.locfileid: "58639591"
---
# <a name="customize-the-search-results-page"></a>Настройка страницы результатов поиска

Вы можете *создать* вертикали поиска и типы результатов для настройки результатов поиска, которые пользователи видят при поиске в Microsoft [SharePoint,](https://sharepoint.com/) [Microsoft Office](https://office.com)и Поиск (Майкрософт) в [Bing](https://bing.com).  Вертикали упрощают поиск пользователями сведений, которые они могут видеть.

Например, можно создать вертикаль поиска для анализа маркетинговых данных из сторонних программ для пользователей в отделе маркетинга. Вы также можете определить типы результатов и настроить макет для этих данных.

## <a name="about-search-verticals"></a>О вертикалях поиска

В верхней части страницы результатов Поиск (Майкрософт) строка вкладок. Это вертикали поиска. Вертикаль поиска показывает только результаты определенного типа или определенного набора контента. Примерами являются **Файлы** или **Новости.** По умолчанию Поиск (Майкрософт) показывает вертикали **All**, **People**, **Files,** **Sites** и **News**.  

Можно добавить вертикали поиска, которые имеют отношение к организации. Они отображаются на странице Поиск (Майкрософт) результатов в SharePoint, Office и Bing. Например, можно создать вертикаль для контента, связанного с маркетингом, а другое — для продаж, основываясь на типе информации, которая требуется каждому отделу. Можно добавить вертикали, чтобы показывать результаты только из контента, индексного через соединители.

Можно создавать вертикали и типы результатов на двух уровнях:

- **Уровень** организации — вертикаль, создаемая на уровне организации, отображается [](https://sharepoint.com/) на странице результатов [](https://office.com)поиска при поиске пользователей со своей SharePoint страницы, Office или Bing [.](https://bing.com)
- **Уровень сайта** . Например, может потребоваться включить сотрудников службы обслуживания клиентов для поиска инцидентов строгости *1* непосредственно с веб-сайта SharePoint отдела.

### <a name="multiple-connections-in-a-vertical"></a>Несколько подключений в вертикали

Вертикаль поиска может поверхности результатов из нескольких источников соединителя. Этот параметр обеспечивает гибкость при разработке страницы результатов поиска. Процесс вертикальной установки позволяет администраторам выбирать несколько подключений в шаге "Источник контента".

Если вы точно назначим как можно больше семантических меток, этот опыт будет улучшен.  Вы добавляете семантические метки в точке определения схемы и их продекации. [Дополнительные возможности создания и управления семантическими метами.](configure-connector.md#step-6-assign-property-labels)
[Дополнительные](configure-connector.md#step-6-assign-property-labels) сведения о создании и управлении семантическими метами.

> [!NOTE]
> Несколько подключений в вертикальной функции в настоящее время находятся в предварительном просмотре. Дополнительные сведения см. в [дополнительных сведениях о функции предварительного просмотра соединители.](connectors-overview.md#what-are-the-preview-features)

Подключение может быть добавлено в качестве источника контента в рамках единой вертикали. Подключения нельзя использовать по нескольким вертикалям.

Чтобы настроить запрос для вертикали поиска, в которой добавлено несколько источников подключения, используйте общие исходные свойства для создания запроса.

### <a name="before-you-create-verticals-and-result-types"></a>Перед созданием вертикали и типов результатов

Учтите следующие факторы:

- Убедитесь, что соединитектор был проиндексировали. Это может занять до 48 часов в зависимости от размера файла.

- Вы не можете создать вертикаль для контента, расположенного в SharePoint.

Это шаги по реализации вертикали:

1. Создайте вертикаль. На этом шаге определяется имя, источник контента вертикали и область поиска контента.
2. Определите, как будут выглядеть результаты для этой вертикали.  
3. Включить вертикальную (отображаемую) со страницы вертикального списка.

## <a name="step-1-create-the-search-vertical"></a>Шаг 1. Создание вертикали поиска

После запуска мастера вы будете руководствоваться действиями, чтобы определить имя вертикали, источник контента и область поиска контента.

>[!Note]
>Вертикали создаются в состоянии отключения. Вы позволяете им сделать их просмотримыми.

Чтобы сузить область, можно использовать ограниченный набор языка запросов ключевых слов [(KQL).](/sharepoint/dev/general-development/keyword-query-language-kql-syntax-reference) (Свойства, которые можно использовать, описаны позже в этой статье.) Мы рекомендуем использовать ключевые слова и ограничения свойств с операторами boolean. KQL также поддерживает [переменные запроса профилей](#profile-query-variables) для точной настройки результатов по вертикали.

### <a name="create-a-vertical-at-the-organization-level"></a>Создание вертикали на уровне организации

Чтобы создать вертикальную Поиск (Майкрософт) в SharePoint, Office или Bing выполните следующие действия:

1. В [Центр администрирования Microsoft 365](https://admin.microsoft.com)перейдите к [**вертикалям**](https://admin.microsoft.com/Adminportal/Home#/MicrosoftSearch/verticals).
2. Выберите **Добавить,** чтобы начать работу.  

### <a name="create-a-vertical-at-the-site-level"></a>Создание вертикали на уровне сайта

1. На [сайте SharePoint,](https://sharepoint.com/) где нужна вертикаль, перейдите **в Параметры.**
2. Выберите **сведения о сайте,** а затем выберите Просмотр **всех параметров сайта.**
3. Найдите **раздел Поиск (Майкрософт),** а затем **выберите Настройка Поиск (Майкрософт) для этой коллекции сайтов.**
4. В области навигации перейдите к **пользовательскому опыту** и выберите вкладку **Verticals.**
5. Чтобы добавить вертикаль, выберите **Добавить**. Или чтобы изменить вертикаль, выберите ее из списка.

## <a name="step-2-create-result-types"></a>Шаг 2. Создание типов результатов

Типы *результатов можно использовать* для определения отображения результатов в вертикали. Макет результатов позволяет показывать важные сведения непосредственно в результатах поиска, поэтому пользователям не нужно выбирать каждый результат, чтобы узнать, нашли ли они то, что ищут.

### <a name="default-search-result-layout"></a>Макет результатов поиска по умолчанию

Макет результатов поиска по умолчанию будет показан  для  контента соединительщика, если метки и свойства контента были правильно соединялись с исходными свойствами при настройке соединиттеля. Метка *заголовка* — это самая важная метка. Мы *настоятельно* рекомендуем использовать свойство, назначенное этой метке, для использования макета результатов поиска по умолчанию.

### <a name="create-your-own-result-type"></a>Создание собственного типа результатов

Для создания собственного макета результатов поиска и переопределения макета результатов поиска по умолчанию создается *тип результатов.* Тип результата поиска  это правило, благодаря которому результаты поиска разных типов отображаются различными способами. Она состоит из перечисленных ниже элементов.

- **Одно или несколько условий** для сравнения каждого результата поиска, например источника контента результата поиска.  
- Макет **результатов** для использования для результатов поиска, которые соответствуют условиям. Полученный макет управляет тем, как отображаются результаты, которые соответствуют условиям, и ведут себя на странице результатов поиска.

*Если вы не делаете соответствующее сопоставление для отображения макета результатов поиска по умолчанию, необходимо создать по крайней мере один тип результатов для отображения результатов по вертикали.* 

Можно создать несколько типов результатов для каждой вертикали, что позволяет использовать различные макеты для различных типов результатов. Например, можно настроить *инциденты строгости 1,* чтобы иметь более заметные цвета и шрифт большего размера, чем *инциденты строгости 3.*

После запуска мастера вы будете руководствоваться действиями, чтобы определить имя, источник контента и условия для типа результата. Вы можете определить приоритет типа результатов из представления списка.
  
### <a name="create-a-result-type-at-the-organization-level"></a>Создание типа результатов на уровне организации

1. В [Центр администрирования Microsoft 365](https://admin.microsoft.com)перейдите к [**типам Result.**](https://admin.microsoft.com/Adminportal/Home#/MicrosoftSearch/resulttypes)
2. Чтобы добавить тип результата, выберите **Добавить**. Чтобы изменить тип результатов, выберите тип результата из соответствующего списка.

### <a name="create-a-result-type-at-the-site-level"></a>Создание типа результатов на уровне сайта

1. На [сайте SharePoint,](https://sharepoint.com/) на котором вы хотите тип результата, перейдите в **Параметры.**
2. Выберите **сведения о сайте,** а затем выберите Просмотр **всех параметров сайта.**
3. Посмотрите раздел **Поиск (Майкрософт),** а затем выберите **Configure Поиск (Майкрософт) для этой коллекции сайтов.**
4. В области навигации перейдите к **настраиваемой области** и выберите вкладку **тип результатов.**
5. Чтобы добавить тип результата, выберите **Добавить**.  Или, чтобы изменить тип результатов, выберите тип результата в списке.

## <a name="step-3-view-the-vertical-after-its-enabled"></a>Шаг 3. Просмотр вертикали после включения

После в включить вертикаль, есть задержка в несколько часов, прежде чем вы можете просмотреть его. Но вы можете приложение `cacheClear=true` к URL-адресу в SharePoint и Office, чтобы просмотреть вертикаль немедленно. Для Bing прим. приложение `&features=uncachedVerticals` к `Work vertical URL` вертикали, чтобы просмотреть ее немедленно.

> [!NOTE]
> Добавленные вертикали не видны на SharePoint]( и Office при просмотре https://sharepoint.com/) из мобильных [](https://office.com) веб-браузеров.

## <a name="profile-query-variables"></a>Переменные запроса профилей

Используйте переменные в разделе запроса KQL вертикали для предоставления динамических данных в качестве ввода запроса вертикальной. Вы можете использовать переменные запроса профилей, чтобы сделать результаты поиска контекстными для подписанного пользователя. Переменные запроса профилей извлекли значения из профиля подписанного [пользователя.](/graph/api/resources/profile)

Например, чтобы создать вертикаль "Билеты", чтобы пользователь нашел назначенные им билеты поддержки, можно указать следующий запрос в разделе "Запрос" во время создания вертикали на странице администрирования:  

`AssignedTo:{Profile.accounts.userPrincipalName}`

Этот язык сужает результаты поиска, чтобы показать только те элементы, для которых назначаемая является пользователем, который выполняет поиск.

[Ресурс Profile](/graph/api/resources/profile) предоставляет свойства в качестве коллекций. Например, сведения, относящиеся к адресам электронной почты, высвечив их через коллекцию электронной почты, позиции в качестве коллекции позиций и так далее. Все свойства, доступные в профиле пользователя, которые имеют AAD как исходный тип, выставляются в качестве переменных Запроса.


Рассмотрим пользователя, у которого в коллекции электронной почты есть три адреса электронной почты, как показано здесь:

```json
"emails": [{ 

        "address": "Megan.Bowen@contoso.com",
        "id": "xyz", 
        "source": { 
            "CreatedBy": "xyz", 
            "CreatedOn": "2222", 
            "Type": "official" 
        },
        "type": "main" 
    }, { 
        "address": "meganb@hotmail.com",
        "id": "abc", 
        "source": { 
            "CreatedBy": "abc",
            "CreatedOn": "3333", 
            "Type": "non-official",
        },
        "type": "work"
    }, { 
        "address": "meganb@outlook.com",
        "id": "pqr", 
        "source": { 
            "CreatedBy": "pqr", 
            "CreatedOn": "4444", 
            "Type": "personal" 
        },
        "type": "personal" 
    } 
] 
```

- Запрос будет `MyProperty: {Profile.emails.address}` *решаться в MyProperty: "Megan.Bowen@contoso.com".*  

- Чтобы устранить все значения атрибута адреса, используйте синтаксис расширения с несколькими значениями. Запрос будет разрешать `{|MyProperty:{Profile.emails.address}}` *(((MyProperty:"Megan.Bowen@contoso \. com")* или *(MyProperty: "meganb@hotmail \. com")* или *(MyProperty:"meganb@outlook \. com")).*

Использование оператора "|" для устранения переменных с несколькими значениями. Дополнительные примеры расширения профиля см. в следующей таблице.

| #         | Синтаксис |  Возвращено значение  |
| --------- | ------ | --- |
| 1    | MyProperty:{Profile.emails.address}  |   "Меган \. Bowen@contoso.com"  |
| 2 | MyProperty:{Profile.emails}   |    {Profile.emails} Это не решится, так как сообщения электронной *почты* — это объект.|
| 3    | {? MyProperty:{Profile.emails}}  |  Это не решится, *так как сообщения электронной почты* — это объект. The "?" оператор игнорирует переменные запроса, которые не решаются. Эта переменная будет удалена при дальнейшей стеке запросов.   |
| 4  | {&#124;MyProperty: {Profile.emails.source.Type}}    |  ((MyProperty:"official") или (MyProperty:"non-official") или (MyProperty:"personal"))    |

> [!NOTE]
>
> - Переменные запроса профилей поддерживаются только для настраиваемой вертикали, которые используют [соединитель](connectors-overview.md) в качестве источника контента.
> - Переменные запроса профилей определяются в разделе "Запрос" процесса [вертикальной настройки.](customize-search-page.md#step-1-create-the-search-vertical)
> - В настоящее время функция переменных запросов профиля находится в предварительном режиме. Дополнительные сведения о предварительной версии см. в [дополнительных сведениях о функции предварительного просмотра соединители.](connectors-overview.md#what-are-the-preview-features)

## <a name="troubleshooting"></a>Устранение неполадок

Вот список распространенных проблем, с которыми вы можете столкнуться, и действий по их устранению.

|Проблема  |Action  |
|---------|---------|
| Я вижу сообщение об ошибке "Что-то пошло не так" на вертикали. | Для завершения установки необходимы как вертикальные типы, так и типы результатов. Убедитесь, что вы создали оба источника контента. |
| Я не вижу макет результатов, хотя создал его. | Может быть задержка в несколько минут, так как эти параметры кэшировали. Подождите несколько минут и попробуйте еще раз.        |
| Я не вижу источников контента на странице вертикального или типа результатов. | Убедитесь, что вы настроили соединители и проиндексировали данные.   |

## <a name="next-steps"></a>Дальнейшие действия

[Настройка макета результатов](customize-results-layout.md)
